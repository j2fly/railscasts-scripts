#!/usr/bin/env ruby

# Uploads compressed files to media.railscasts.com
# rcupload path/to/123-foo-bar

require "fileutils"

def run(command)
  puts "Running: #{command}"
  system(command)
end

path = ($*.first || ".") + "/upload/**/*.*"
Dir[path].each do |file|
  run "scp '#{file}' media.railscasts.com:/home/rbates/media.railscasts.com/assets/episodes/#{file.sub('./upload/', '')}"
  run "scp '#{file}' railscasts.com:~/code/railscasts/shared/assets/episodes/stills/" if file =~ /stills\/.*\.png/
end
